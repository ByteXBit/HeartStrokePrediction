<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heart Stroke Prediction</title>
    <style>
        body {
            background-color: #f5f0ff;
            color: #ffffff;
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            font-size: 16px;
        }
        .container {
            max-width: 1000px;
            margin: auto;
        }
        .card {
            background-color: #ffffff;
            color: #333333;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        h1, h2, h3 {
            color: #4b0082;
        }
        img {
            width: 100%;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            margin-top: 10px;
            margin-bottom: 20px;
        }
        a.button {
            display: inline-block;
            padding: 12px 24px;
            background-color: #6a0dad;
            color: #ffffff;
            text-decoration: none;
            border-radius: 8px;
            margin-top: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            font-weight: bold;
        }
        a.button:hover {
            background-color: #5800b2;
        }
    </style>
</head>
<body>
<div class="container">

    <div class="card">
        <h1>HeartStrokePrediction</h1>
        <h2>Introduction</h2>
        <p>This project aims to analyze and predict the likelihood of a stroke based on various health factors using Machine Learning (ML) and Deep Learning (DL) models. We performed detailed <strong>data cleaning</strong>, <strong>visualization</strong>, <strong>feature engineering</strong>, <strong>model building</strong>, and <strong>evaluation</strong>. This was done as part of an academic project to understand end-to-end Machine Learning pipelines and Deep Learning modeling.</p>
    </div>

    <div class="card">
        <h2>1. Data Preprocessing</h2>
        <h3>Loading and Exploring Data</h3>
        <p>The dataset <code>healthcare-dataset-stroke-data.csv</code> was loaded using pandas.</p>
        <pre><code>data.shape
data.describe()</code></pre>
        
        <h3>Handling Missing Values</h3>
        <p>- Filled missing <code>bmi</code> values with mean values grouped by gender, marital status, and age group.<br>- Dropped <code>id</code> column.</p>
        
        <h3>Feature Engineering</h3>
        <p>- Created <code>age_group</code>.<br>- Removed rows with gender = 'Other'.</p>
    </div>

    <div class="card">
        <h2>2. Data Visualization and Analysis</h2>
        <p>We used Plotly Express, Seaborn, and Matplotlib.</p>
        <img src="https://github.com/user-attachments/assets/7ba46767-37fb-4ed4-9fc8-3013fc0d1d9d" alt="Gender vs Stroke">
        <img src="https://github.com/user-attachments/assets/98995bf4-b5fa-4447-b505-74faea007988" alt="Age vs Stroke">
        <img src="https://github.com/user-attachments/assets/da44c94d-ac76-4291-a30c-c66e98e6f757" alt="Hypertension vs Stroke">
        <img src="https://github.com/user-attachments/assets/7dd78d27-368e-46f0-a693-45ec81516144" alt="Heart Disease vs Stroke">
        <img src="https://github.com/user-attachments/assets/36bc7146-412c-4368-808c-c158c68a3c25" alt="Marital Status vs Stroke">
        <img src="https://github.com/user-attachments/assets/4f93498b-6cf5-47e0-a4c1-ebc406eb7ecd" alt="Work Type vs Stroke">
        <img src="https://github.com/user-attachments/assets/48b1225c-56d2-49a7-82e9-c5bdc4feed09" alt="Residence Type vs Stroke">
        <img src="https://github.com/user-attachments/assets/3e56c75f-6196-4973-a31a-ace2c1fcaea8" alt="Average Glucose Level vs Stroke">
        <img src="https://github.com/user-attachments/assets/d91e1f9c-25f5-4ebd-9a11-7a6e1b606420" alt="BMI vs Stroke">
        <img src="https://github.com/user-attachments/assets/4037ec0c-e55a-4e5c-8c79-8557dac95b5f" alt="Smoking Status vs Stroke">
    </div>

    <div class="card">
        <h2>3. Handling Class Imbalance</h2>
        <p>Used Upsampling and SMOTE to balance dataset.</p>
    </div>

    <div class="card">
        <h2>4. Data Scaling</h2>
        <p>Normalized <code>age</code>, <code>avg_glucose_level</code>, and <code>bmi</code> using MinMaxScaler or StandardScaler.</p>
    </div>

    <div class="card">
        <h2>5. Machine Learning Models</h2>
        <p>We implemented several models:</p>
        <ul>
            <li><strong>Extra Trees Classifier</strong></li>
            <li><strong>Random Forest Classifier</strong></li>
            <li><strong>XGBoost Classifier</strong></li>
            <li><strong>Gradient Boosting Classifier</strong></li>
        </ul>
        <pre><code>
etc_model = ExtraTreesClassifier()
rfc_model = RandomForestClassifier(n_estimators=29, max_leaf_nodes=900, max_features=0.8, criterion='entropy')
xgb_model = XGBClassifier(objective="binary:logistic", eval_metric="auc")
gbc_model = GradientBoostingClassifier(max_depth=29, min_samples_leaf=4, min_samples_split=13, subsample=0.8)

models = [etc_model, rfc_model, xgb_model, gbc_model]
for model in models:
    model.fit(x_train, y_train)
        </code></pre>
    </div>

    <div class="card">
        <h2>6. Deep Learning Models (ANN)</h2>
        <h3>Basic Neural Network</h3>
        <pre><code>
model = Sequential([
    Dense(16, input_dim=X.shape[1], activation='relu'),
    Dense(8, activation='relu'),
    Dense(1, activation='sigmoid')
])
        </code></pre>

        <h3>Improved Neural Network</h3>
        <pre><code>
model = Sequential([
    Dense(32, activation='relu', input_dim=X_train.shape[1]),
    Dropout(0.3),
    Dense(16, activation='relu'),
    Dense(1, activation='sigmoid')
])

early_stop = EarlyStopping(monitor='val_loss', patience=5, restore_best_weights=True)
        </code></pre>
    </div>

    <div class="card">
        <h2>7. Evaluation</h2>
        <p>Used Classification Reports, Confusion Matrices, and Accuracy Scores.</p>
    </div>

    <div class="card">
        <h2>8. Conclusion</h2>
        <p>Learned complete Machine Learning and Deep Learning pipeline creation with healthcare datasets.</p>
    </div>

    <div class="card">
        <h2>üìä Technologies Used</h2>
        <p>Python, Pandas, Numpy, Matplotlib, Seaborn, Plotly Express, Scikit-learn, XGBoost, TensorFlow, Keras, imbalanced-learn (SMOTE).</p>
    </div>

    <div class="card">
        <h2>üìÅ Dataset</h2>
        <p><a href="https://www.kaggle.com/datasets/fedesoriano/stroke-prediction-dataset" target="_blank">Healthcare Dataset for Stroke Prediction (Kaggle)</a></p>
    </div>

    <div class="card">
        <h2>About the Team</h2>
        <p>Atharva Chhaparwal (23ucs550)<br>Aryan Dadhich (23ucs547)<br>Aviral Saini (23ucs551)</p>
    </div>

    <div class="card" style="text-align:center;">
        <a href="https://colab.research.google.com/drive/11rXUSkdFqVqbTrouzHW0VSrDDWYIu5C9?usp=sharing#scrollTo=XEmfFdxWpEAI" class="button" target="_blank">Open Project Notebook on Google Colab</a>
    </div>

</div>
</body>
</html>
