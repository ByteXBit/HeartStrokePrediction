<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heart Stroke Prediction</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #2c2c2c;
            color: #ffffff;
            font-family: 'Poppins', sans-serif;
            line-height: 1.6;
            padding: 20px;
        }
        h1, h2, h3 {
            color: #ffffff;
            border-bottom: 2px solid #555;
            padding-bottom: 5px;
        }
        section {
            background: #3a3a3a;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.5);
            margin-bottom: 30px;
        }
        img {
            width: 100%;
            max-width: 700px;
            display: block;
            margin: 20px auto;
            border-radius: 10px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.6);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #555;
        }
        code {
            background: #1f1f1f;
            padding: 5px 10px;
            border-radius: 5px;
            display: block;
            white-space: pre-wrap;
            margin-top: 10px;
            margin-bottom: 10px;
        }
        a {
            color: #4fc3f7;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>

<section>
<h1>HeartStrokePrediction</h1>

<h2>Introduction</h2>
<p>This project aims to analyze and predict the likelihood of a stroke based on various health factors using Machine Learning (ML) and Deep Learning (DL) models.<br>
We performed detailed <strong>data cleaning</strong>, <strong>visualization</strong>, <strong>feature engineering</strong>, <strong>model building</strong>, and <strong>evaluation</strong>.<br>
This was done as part of an academic project to understand end-to-end Machine Learning pipelines and Deep Learning modeling.</p>
</section>

<section>
<h2>1. Data Preprocessing</h2>

<h3>Loading and Exploring Data</h3>
<ul>
<li>The dataset <code>healthcare-dataset-stroke-data.csv</code> was loaded using <strong>pandas</strong>.</li>
<li>Basic information such as <strong>shape</strong> and <strong>statistical description</strong> was obtained to understand the dataset.</li>
</ul>

<code>data.shape
data.describe()</code>

<h3>Handling Missing Values</h3>
<ul>
<li>The <code>bmi</code> column had missing values.</li>
<li>Missing <code>bmi</code> values were filled with the <strong>mean</strong> value of BMI, grouped by <strong>gender</strong>, <strong>marital status</strong>, and <strong>age group</strong>.</li>
<li>The <code>id</code> column was dropped.</li>
</ul>

<h3>Feature Engineering</h3>
<ul>
<li>An <code>age_group</code> column was created to categorize individuals.</li>
<li>Rows with ambiguous gender ("Other") were removed.</li>
</ul>
</section>

<section>
<h2>2. Data Visualization and Analysis</h2>
<p>We used <strong>Plotly Express</strong>, <strong>Seaborn</strong>, and <strong>Matplotlib</strong> to visualize:</p>

<ul>
<li>Gender vs Stroke</li>
<img src="https://github.com/user-attachments/assets/7ba46767-37fb-4ed4-9fc8-3013fc0d1d9d" alt="Gender vs Stroke">

<li>Age vs Stroke</li>
<img src="https://github.com/user-attachments/assets/98995bf4-b5fa-4447-b505-74faea007988" alt="Age vs Stroke">

<li>Hypertension vs Stroke</li>
<img src="https://github.com/user-attachments/assets/da44c94d-ac76-4291-a30c-c66e98e6f757" alt="Hypertension vs Stroke">

<li>Heart Disease vs Stroke</li>
<img src="https://github.com/user-attachments/assets/7dd78d27-368e-46f0-a693-45ec81516144" alt="Heart Disease vs Stroke">

<li>Marital Status vs Stroke</li>
<img src="https://github.com/user-attachments/assets/36bc7146-412c-4368-808c-c158c68a3c25" alt="Marital Status vs Stroke">

<li>Work Type vs Stroke</li>
<img src="https://github.com/user-attachments/assets/4f93498b-6cf5-47e0-a4c1-ebc406eb7ecd" alt="Work Type vs Stroke">

<li>Residence Type vs Stroke</li>
<img src="https://github.com/user-attachments/assets/48b1225c-56d2-49a7-82e9-c5bdc4feed09" alt="Residence Type vs Stroke">

<li>Average Glucose Level vs Stroke</li>
<img src="https://github.com/user-attachments/assets/3e56c75f-6196-4973-a31a-ace2c1fcaea8" alt="Avg Glucose vs Stroke">

<li>BMI vs Stroke</li>
<img src="https://github.com/user-attachments/assets/d91e1f9c-25f5-4ebd-9a11-7a6e1b606420" alt="BMI vs Stroke">

<li>Smoking Status vs Stroke</li>
<img src="https://github.com/user-attachments/assets/4037ec0c-e55a-4e5c-8c79-8557dac95b5f" alt="Smoking vs Stroke">
</ul>
</section>

<section>
<h2>3. Handling Class Imbalance</h2>
<p>The dataset was highly imbalanced. We used <strong>Upsampling</strong> and <strong>SMOTE</strong> to balance the dataset:</p>
<ul>
<li>Upsampling involved duplicating minority samples.</li>
<li>SMOTE generated synthetic samples.</li>
</ul>
</section>

<section>
<h2>4. Data Scaling</h2>
<p>Continuous features like <code>age</code>, <code>avg_glucose_level</code>, and <code>bmi</code> were normalized using <strong>MinMaxScaler</strong> or <strong>StandardScaler</strong>.</p>
</section>

<section>
<h2>5. Machine Learning Models</h2>
<p>We implemented and trained several models:</p>

<table>
<tr><th>Model</th><th>Key Details</th></tr>
<tr><td>Extra Trees Classifier</td><td>Ensemble method</td></tr>
<tr><td>Random Forest Classifier</td><td>Ensemble method, tuned</td></tr>
<tr><td>XGBoost Classifier</td><td>Advanced boosting</td></tr>
<tr><td>Gradient Boosting Classifier</td><td>Boosted ensemble</td></tr>
</table>

<p>Example model training:</p>
<code>
etc_model = ExtraTreesClassifier()
rfc_model = RandomForestClassifier(n_estimators=29, max_leaf_nodes=900, max_features=0.8, criterion='entropy')
xgb_model = XGBClassifier(objective="binary:logistic", eval_metric="auc")
gbc_model = GradientBoostingClassifier(max_depth=29, min_samples_leaf=4, min_samples_split=13, subsample=0.8)

models = [etc_model, rfc_model, xgb_model, gbc_model]
for model in models:
    model.fit(x_train, y_train)
</code>
</section>

<section>
<h2>6. Deep Learning Models (ANN)</h2>
<h3>Basic Neural Network</h3>
<p>A simple ANN model:</p>
<code>
model = Sequential([
    Dense(16, input_dim=X.shape[1], activation='relu'),
    Dense(8, activation='relu'),
    Dense(1, activation='sigmoid')
])
</code>

<h3>Improved Neural Network</h3>
<p>Handled imbalance with SMOTE and added Dropout:</p>
<code>
model = Sequential([
    Dense(32, activation='relu', input_dim=X_train.shape[1]),
    Dropout(0.3),
    Dense(16, activation='relu'),
    Dense(1, activation='sigmoid')
])

early_stop = EarlyStopping(monitor='val_loss', patience=5, restore_best_weights=True)
</code>
</section>

<section>
<h2>7. Evaluation</h2>
<ul>
<li>Classification reports showed precision, recall, and f1-score.</li>
<li>Confusion matrices visualized model performance.</li>
<li>Test accuracy was measured for all models.</li>
</ul>
</section>

<section>
<h2>8. Conclusion</h2>
<p>Through this project, we learned how to:</p>
<ul>
<li>Preprocess healthcare datasets.</li>
<li>Handle missing values thoughtfully.</li>
<li>Balance datasets with resampling and SMOTE.</li>
<li>Build and evaluate ML and DL models.</li>
<li>Use proper evaluation techniques.</li>
</ul>
<p>This helped us understand critical steps in healthcare prediction systems.</p>
</section>

<section>
<h2>üìä Technologies Used</h2>
<ul>
<li>Python</li>
<li>Pandas, Numpy</li>
<li>Matplotlib, Seaborn, Plotly Express</li>
<li>Scikit-learn</li>
<li>XGBoost</li>
<li>TensorFlow, Keras</li>
<li>imbalanced-learn (SMOTE)</li>
</ul>
</section>

<section>
<h2>üìÅ Dataset</h2>
<p><strong>Healthcare Dataset for Stroke Prediction</strong> (<a href="https://www.kaggle.com/datasets/fedesoriano/stroke-prediction-dataset" target="_blank">available on Kaggle</a>).</p>
</section>

</body>
</html>
